-- Tabla de clientes
CREATE TABLE CLIENTE (
    ID_CLIENTE INT AUTO_INCREMENT PRIMARY KEY,
    NOMBRE VARCHAR(100) NOT NULL,
    CEDULA VARCHAR(20) NOT NULL,
    TELEFONO VARCHAR(20),
    CORREO VARCHAR(150),
    OBSERVACIONES TEXT,
    ENCARGADO VARCHAR(100),
    DISPOSITIVO VARCHAR(50)
);

-- Tabla de formularios de reparación
CREATE TABLE FORMULARIO_REPARACION (
    ID_FORMULARIO INT AUTO_INCREMENT PRIMARY KEY,
    ID_CLIENTE INT,
    DIAGNOSTICO TEXT,
    PRECIO_ESTIMADO DECIMAL(10,2),
    ESTATUS VARCHAR(50),
    FECHA_INGRESO DATE,
    TECNICO_ASIGNADO VARCHAR(100),
    FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE(ID_CLIENTE),
    BORRADOLOGICO TINYINT NOT NULL DEFAULT 1
);

-- Tabla de historial de clientes
CREATE TABLE HISTORIAL_CLIENTE (
    ID_HISTORIAL INT AUTO_INCREMENT PRIMARY KEY,
    ID_CLIENTE INT,
    ID_FORMULARIO INT,
    MODELO VARCHAR(100),
    PRECIO_FINAL DECIMAL(10,2),
    ESTATUS VARCHAR(50),
    FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE(ID_CLIENTE),
    FOREIGN KEY (ID_FORMULARIO) REFERENCES FORMULARIO_REPARACION(ID_FORMULARIO)
);

--Tabla para los usuarios
CREATE TABLE usuario (
	ID_USUARIO INT AUTO_INCREMENT PRIMARY KEY,
    CORREO VARCHAR(320) NOT NULL UNIQUE,
    CONTRASENA VARCHAR(255) NOT NULL,
    ROL ENUM('admin', 'usuario', 'cliente'),
    FECHA_REGISTRO TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Datos de prueba
INSERT INTO cliente (NOMBRE, CEDULA, TELEFONO, CORREO, OBSERVACIONES, ENCARGADO, DISPOSITIVO) VALUES
('Cristian', '111111111', '88888888', 'cristian@mail.com', 'Cliente frecuente', 'Juan Pérez', 'Celular'),
('Mariana', '222222222', '70001111', 'mariana@gmail.com', 'Viene por segunda vez', 'María Rodríguez', 'Tablet'),
('Kevin', '333333333', '60000000', 'kevin@hotmail.com', 'Revisión pendiente', 'Pablo Ramírez', 'Computadora');

INSERT INTO formulario_reparacion (ID_CLIENTE, DIAGNOSTICO, PRECIO_ESTIMADO, ESTATUS, FECHA_INGRESO, TECNICO_ASIGNADO) VALUES
(1, 'Pantalla rota', 25000, 'Pendiente', '2024-11-05', 'Juan Pérez'),
(2, 'Problema de batería', 18000, 'En proceso', '2024-11-10', 'Ana Morales'),
(3, 'No enciende el dispositivo', 0, 'Diagnóstico', '2024-11-12', 'Pablo Ramírez');

INSERT INTO historial_cliente (ID_CLIENTE, ID_FORMULARIO, MODELO, PRECIO_FINAL, ESTATUS) VALUES
(1, 1, 'Samsung S24', 238904, 'En Proceso');


